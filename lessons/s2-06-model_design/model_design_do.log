----------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/doylewr/practicum_2018/central/lessons/s2-06-model_design/model_design_do.
> log
  log type:  text
 opened on:  19 Feb 2019, 12:55:52

. 
. /* Model specification, interactions, prediction and plots after interaction*/
. /* Will Doyle */
. /* 2019-02-19 */
. /* Practicum Folder */
. 
. clear

. 
. clear matrix

. 
. graph drop _all

. 
. estimates clear /* Clears any estimates hanging around */

. 
. set more off /*Get rid of annoying "more" feature */

. 
. //ssc install bcuse
. 
. ssc install nnest
checking nnest consistency and verifying not already installed...
all files already exist and are up to date.

. 
. bcuse wage2, clear

Contains data from http://fmwww.bc.edu/ec-p/data/wooldridge/wage2.dta
  obs:           935                          
 vars:            17                          26 Jan 2000 12:16
 size:        63,580                          
----------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
----------------------------------------------------------------------------------------------
wage            float   %9.0g                 
hours           float   %9.0g                 
IQ              float   %9.0g                 
KWW             float   %9.0g                 
educ            float   %9.0g                 
exper           float   %9.0g                 
tenure          float   %9.0g                 
age             float   %9.0g                 
married         float   %9.0g                 
black           float   %9.0g                 
south           float   %9.0g                 
urban           float   %9.0g                 
sibs            float   %9.0g                 
brthord         float   %9.0g                 
meduc           float   %9.0g                 
feduc           float   %9.0g                 
lwage           float   %9.0g                 
----------------------------------------------------------------------------------------------
Sorted by: 

. 
. label variable wage "Wages from work in last month"

. 
. label variable hours "Weekly hours"

. 
. label variable IQ "IQ test"

. 
. label variable KWW "Knowledge of world of work"

. 
. label variable educ "Years of education"

. 
. label variable tenure "Months in current job"

. 
. label variable age "Age"

. 
. label variable married "Married"

. 
. label variable black "African-American"

. 
. label variable south "South"

. 
. label variable urban "Urban"

. 
. label variable sibs "No. Siblings"

. 
. label variable brthord "Birth order"

. 
. label variable meduc "Mother's years of school"

. 
. label variable feduc "Father's years of education"

. 
. label variable lwage "ln Wage"

. 
. renvars *, lower

. 
. save wage2, replace
file wage2.dta saved

. 
. /*Constants*/
. 
.     local sig=.05

. 
. local sigtail=`sig'/2

. 
. /*Plots of data */
. 
. graph twoway scatter wage educ 

. 
. graph export "wage_educ.pdf", replace 
(file /Users/doylewr/practicum_2018/central/lessons/s2-06-model_design/wage_educ.pdf written i
> n PDF format)

. 
. graph twoway qfit wage age||scatter wage age 

. 
. graph export "wage_age.pdf", replace  
(file /Users/doylewr/practicum_2018/central/lessons/s2-06-model_design/wage_age.pdf written in
>  PDF format)

. 
. /*Missing Data */ 
.     
. di _N
935

.   
. reg lwage hours educ age

      Source |       SS           df       MS      Number of obs   =       935
-------------+----------------------------------   F(3, 931)       =     46.91
       Model |  21.7514568         3  7.25048559   Prob > F        =    0.0000
    Residual |  143.904838       931   .15457018   R-squared       =    0.1313
-------------+----------------------------------   Adj R-squared   =    0.1285
       Total |  165.656294       934  .177362199   Root MSE        =    .39315

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0047011   .0017887    -2.63   0.009    -.0082115   -.0011906
        educ |   .0616404   .0058814    10.48   0.000     .0500981    .0731827
         age |   .0227339   .0041411     5.49   0.000     .0146069    .0308608
       _cons |   5.403279   .1732026    31.20   0.000     5.063366    5.743191
------------------------------------------------------------------------------

. 
. reg lwage hours educ age meduc

      Source |       SS           df       MS      Number of obs   =       857
-------------+----------------------------------   F(4, 852)       =     38.47
       Model |  22.8514162         4  5.71285406   Prob > F        =    0.0000
    Residual |  126.509635       852  .148485487   R-squared       =    0.1530
-------------+----------------------------------   Adj R-squared   =    0.1490
       Total |  149.361051       856  .174487209   Root MSE        =    .38534

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0058052   .0018374    -3.16   0.002    -.0094115   -.0021989
        educ |   .0525597   .0064521     8.15   0.000     .0398957    .0652236
         age |   .0243798   .0042747     5.70   0.000     .0159896      .03277
       meduc |   .0184424   .0049725     3.71   0.000     .0086826    .0282022
       _cons |    5.33402   .1776844    30.02   0.000      4.98527    5.682771
------------------------------------------------------------------------------

. 
. reg lwage hours educ age feduc

      Source |       SS           df       MS      Number of obs   =       741
-------------+----------------------------------   F(4, 736)       =     34.17
       Model |  20.2139719         4  5.05349299   Prob > F        =    0.0000
    Residual |  108.836202       736  .147875274   R-squared       =    0.1566
-------------+----------------------------------   Adj R-squared   =    0.1521
       Total |  129.050173       740  .174392126   Root MSE        =    .38455

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |   -.007041   .0019639    -3.59   0.000    -.0108964   -.0031855
        educ |   .0475258   .0070026     6.79   0.000     .0337785    .0612732
         age |   .0262759   .0045806     5.74   0.000     .0172834    .0352685
       feduc |   .0172076   .0047569     3.62   0.000     .0078689    .0265462
       _cons |   5.421121   .1897058    28.58   0.000     5.048692     5.79355
------------------------------------------------------------------------------

. 
. reg lwage hours educ age feduc meduc 

      Source |       SS           df       MS      Number of obs   =       722
-------------+----------------------------------   F(5, 716)       =     27.64
       Model |   20.519095         5  4.10381899   Prob > F        =    0.0000
    Residual |  106.292836       716  .148453682   R-squared       =    0.1618
-------------+----------------------------------   Adj R-squared   =    0.1560
       Total |  126.811931       721    .1758834   Root MSE        =     .3853

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0071408   .0019821    -3.60   0.000    -.0110321   -.0032495
        educ |    .046006   .0072322     6.36   0.000     .0318071    .0602049
         age |   .0249456   .0046705     5.34   0.000     .0157762     .034115
       feduc |   .0114239   .0055571     2.06   0.040     .0005138     .022334
       meduc |   .0132414   .0063094     2.10   0.036     .0008543    .0256285
       _cons |   5.404781   .1929204    28.02   0.000     5.026024    5.783539
------------------------------------------------------------------------------

. 
. gen analytic_sample_flag=e(sample)

. 
. reg lwage hours educ age if analytic_sample_flag==1 

      Source |       SS           df       MS      Number of obs   =       722
-------------+----------------------------------   F(3, 718)       =     39.52
       Model |   17.972245         3  5.99074834   Prob > F        =    0.0000
    Residual |  108.839686       718  .151587307   R-squared       =    0.1417
-------------+----------------------------------   Adj R-squared   =    0.1381
       Total |  126.811931       721    .1758834   Root MSE        =    .38934

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0067617   .0019997    -3.38   0.001    -.0106877   -.0028357
        educ |   .0593979   .0065158     9.12   0.000     .0466056    .0721902
         age |   .0236215   .0046986     5.03   0.000      .014397    .0328461
       _cons |    5.50891   .1932456    28.51   0.000     5.129516    5.888304
------------------------------------------------------------------------------

. 
. reg lwage hours educ age meduc if analytic_sample_flag==1 

      Source |       SS           df       MS      Number of obs   =       722
-------------+----------------------------------   F(4, 717)       =     33.35
       Model |  19.8917203         4  4.97293007   Prob > F        =    0.0000
    Residual |  106.920211       717  .149121633   R-squared       =    0.1569
-------------+----------------------------------   Adj R-squared   =    0.1522
       Total |  126.811931       721    .1758834   Root MSE        =    .38616

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0071587   .0019865    -3.60   0.000    -.0110588   -.0032587
        educ |    .050238   .0069486     7.23   0.000      .036596    .0638801
         age |   .0240817    .004662     5.17   0.000      .014929    .0332345
       meduc |   .0196873   .0054874     3.59   0.000      .008914    .0304606
       _cons |   5.423663   .1931347    28.08   0.000     5.044485     5.80284
------------------------------------------------------------------------------

. 
. gen meduc_flag=meduc==.

. 
. gen feduc_flag=feduc==.

. 
. tab meduc_flag feduc_flag

           |      feduc_flag
meduc_flag |         0          1 |     Total
-----------+----------------------+----------
         0 |       722        135 |       857 
         1 |        19         59 |        78 
-----------+----------------------+----------
     Total |       741        194 |       935 

. 
. 
. /* Quick digression: log transform */
. 
. preserve

. 
. clear

. 
. di log(0)
.

. di log(1)
0

. di log(10)
2.3025851

. di log(100)
4.6051702

. di log(1000)
6.9077553

. 
. set obs 1000
number of observations (_N) was 0, now 1,000

. 
. egen fakenumber= fill(1(10)1000)

. 
. gen log_fakenumber=log(fakenumber)

. 
. graph twoway line log_fakenumber fakenumber

. restore

. 
. 
. /*NOOOOOOOO!!! Stepwise regression*/
. 
. stepwise, pr(.2): reg lwage hours educ age meduc feduc tenure south married black urban sibs
>  kww iq brthord
                      begin with full model
p = 0.3500 >= 0.2000  removing feduc
p = 0.2712 >= 0.2000  removing sibs
p = 0.2237 >= 0.2000  removing brthord

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(11, 651)      =     23.26
       Model |  31.7400529        11  2.88545936   Prob > F        =    0.0000
    Residual |  80.7431222       651  .124029374   R-squared       =    0.2822
-------------+----------------------------------   Adj R-squared   =    0.2700
       Total |  112.483175       662  .169914162   Root MSE        =    .35218

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0067126   .0019326    -3.47   0.001    -.0105074   -.0029177
        educ |   .0332989   .0078237     4.26   0.000     .0179361    .0486617
         age |   .0157517    .005244     3.00   0.003     .0054545    .0260488
       meduc |   .0134071   .0053659     2.50   0.013     .0028706    .0239437
         kww |   .0034485   .0023844     1.45   0.149    -.0012335    .0081305
      tenure |   .0081709   .0028567     2.86   0.004     .0025613    .0137804
       south |  -.0585439   .0305602    -1.92   0.056    -.1185524    .0014646
     married |   .2077864   .0461308     4.50   0.000     .1172033    .2983696
       black |  -.0938556    .054557    -1.72   0.086    -.2009845    .0132733
       urban |   .1980571   .0312361     6.34   0.000     .1367215    .2593928
          iq |   .0034329    .001223     2.81   0.005     .0010314    .0058343
       _cons |   5.151168   .2180037    23.63   0.000     4.723092    5.579243
------------------------------------------------------------------------------

. 
. stepwise, pr(.05): reg lwage hours educ age meduc feduc tenure south married black urban sib
> s kww iq brthord
                      begin with full model
p = 0.3500 >= 0.0500  removing feduc
p = 0.2712 >= 0.0500  removing sibs
p = 0.2237 >= 0.0500  removing brthord
p = 0.1486 >= 0.0500  removing kww
p = 0.0689 >= 0.0500  removing south

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(9, 653)       =     27.69
       Model |  31.0680934         9  3.45201038   Prob > F        =    0.0000
    Residual |  81.4150818       653  .124678533   R-squared       =    0.2762
-------------+----------------------------------   Adj R-squared   =    0.2662
       Total |  112.483175       662  .169914162   Root MSE        =     .3531

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       hours |  -.0064609   .0019327    -3.34   0.001    -.0102559   -.0026659
        educ |   .0347812   .0076565     4.54   0.000     .0197469    .0498156
         age |   .0195908   .0047192     4.15   0.000     .0103242    .0288574
       meduc |   .0150286   .0053333     2.82   0.005      .004556    .0255011
          iq |   .0040984   .0011802     3.47   0.001     .0017809    .0064159
      tenure |   .0088182   .0028499     3.09   0.002     .0032221    .0144143
       urban |   .2102756   .0308692     6.81   0.000     .1496607    .2708905
     married |   .2095021   .0461979     4.53   0.000     .1187877    .3002164
       black |  -.1163507   .0538301    -2.16   0.031    -.2220516   -.0106498
       _cons |   5.000151    .206967    24.16   0.000      4.59375    5.406552
------------------------------------------------------------------------------

. 
. stepwise, pr(.2) : reg lwage south brthord iq kww sibs feduc tenure  married black urban hou
> rs educ age meduc
                      begin with full model
p = 0.3500 >= 0.2000  removing feduc
p = 0.2712 >= 0.2000  removing sibs
p = 0.2237 >= 0.2000  removing brthord

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(11, 651)      =     23.26
       Model |  31.7400529        11  2.88545936   Prob > F        =    0.0000
    Residual |  80.7431222       651  .124029374   R-squared       =    0.2822
-------------+----------------------------------   Adj R-squared   =    0.2700
       Total |  112.483175       662  .169914162   Root MSE        =    .35218

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       south |  -.0585439   .0305602    -1.92   0.056    -.1185524    .0014646
        educ |   .0332989   .0078237     4.26   0.000     .0179361    .0486617
          iq |   .0034329    .001223     2.81   0.005     .0010314    .0058343
         kww |   .0034485   .0023844     1.45   0.149    -.0012335    .0081305
         age |   .0157517    .005244     3.00   0.003     .0054545    .0260488
       meduc |   .0134071   .0053659     2.50   0.013     .0028706    .0239437
      tenure |   .0081709   .0028567     2.86   0.004     .0025613    .0137804
     married |   .2077864   .0461308     4.50   0.000     .1172033    .2983696
       black |  -.0938556    .054557    -1.72   0.086    -.2009845    .0132733
       urban |   .1980571   .0312361     6.34   0.000     .1367215    .2593928
       hours |  -.0067126   .0019326    -3.47   0.001    -.0105074   -.0029177
       _cons |   5.151168   .2180037    23.63   0.000     4.723092    5.579243
------------------------------------------------------------------------------

. 
. stepwise, pr(.05): reg lwage south brthord iq kww sibs feduc tenure  married black urban hou
> rs educ age meduc
                      begin with full model
p = 0.3500 >= 0.0500  removing feduc
p = 0.2712 >= 0.0500  removing sibs
p = 0.2237 >= 0.0500  removing brthord
p = 0.1486 >= 0.0500  removing kww
p = 0.0689 >= 0.0500  removing south

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(9, 653)       =     27.69
       Model |  31.0680934         9  3.45201038   Prob > F        =    0.0000
    Residual |  81.4150818       653  .124678533   R-squared       =    0.2762
-------------+----------------------------------   Adj R-squared   =    0.2662
       Total |  112.483175       662  .169914162   Root MSE        =     .3531

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       urban |   .2102756   .0308692     6.81   0.000     .1496607    .2708905
        educ |   .0347812   .0076565     4.54   0.000     .0197469    .0498156
          iq |   .0040984   .0011802     3.47   0.001     .0017809    .0064159
       hours |  -.0064609   .0019327    -3.34   0.001    -.0102559   -.0026659
         age |   .0195908   .0047192     4.15   0.000     .0103242    .0288574
       meduc |   .0150286   .0053333     2.82   0.005      .004556    .0255011
      tenure |   .0088182   .0028499     3.09   0.002     .0032221    .0144143
     married |   .2095021   .0461979     4.53   0.000     .1187877    .3002164
       black |  -.1163507   .0538301    -2.16   0.031    -.2220516   -.0106498
       _cons |   5.000151    .206967    24.16   0.000      4.59375    5.406552
------------------------------------------------------------------------------

.   
. stepwise, pr(.2) : reg lwage south brthord  kww sibs feduc tenure  married black  hours educ
>  age meduc
                      begin with full model
p = 0.5103 >= 0.2000  removing sibs
p = 0.2146 >= 0.2000  removing brthord

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(10, 652)      =     19.75
       Model |  26.1546559        10  2.61546559   Prob > F        =    0.0000
    Residual |  86.3285193       652  .132405704   R-squared       =    0.2325
-------------+----------------------------------   Adj R-squared   =    0.2207
       Total |  112.483175       662  .169914162   Root MSE        =    .36388

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       south |  -.0886972   .0312376    -2.84   0.005    -.1500357   -.0273588
         age |   .0120413   .0053403     2.25   0.024     .0015551    .0225275
         kww |   .0066253   .0023708     2.79   0.005       .00197    .0112805
       meduc |   .0106574   .0062851     1.70   0.090    -.0016842    .0229989
       feduc |   .0084136   .0055693     1.51   0.131    -.0025224    .0193497
      tenure |   .0078097   .0029507     2.65   0.008     .0020157    .0136036
     married |   .1987501   .0476411     4.17   0.000     .1052016    .2922985
       black |  -.0799257   .0545557    -1.47   0.143    -.1870519    .0272004
       hours |   -.006741   .0019951    -3.38   0.001    -.0106585   -.0028235
        educ |   .0412033   .0075936     5.43   0.000     .0262926    .0561141
       _cons |   5.508661   .2030461    27.13   0.000     5.109958    5.907365
------------------------------------------------------------------------------

. 
. stepwise, pr(.05): reg lwage south brthord  kww sibs feduc tenure  married black  hours educ
>  age meduc
                      begin with full model
p = 0.5103 >= 0.0500  removing sibs
p = 0.2146 >= 0.0500  removing brthord
p = 0.1434 >= 0.0500  removing black
p = 0.1099 >= 0.0500  removing feduc

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(8, 654)       =     24.00
       Model |  25.5304974         8  3.19131217   Prob > F        =    0.0000
    Residual |  86.9526778       654  .132955165   R-squared       =    0.2270
-------------+----------------------------------   Adj R-squared   =    0.2175
       Total |  112.483175       662  .169914162   Root MSE        =    .36463

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       south |  -.1005921   .0307895    -3.27   0.001    -.1610502    -.040134
         age |   .0108531   .0053138     2.04   0.042      .000419    .0212872
         kww |   .0074534   .0023359     3.19   0.001     .0028667    .0120401
       meduc |   .0161784   .0055007     2.94   0.003     .0053773    .0269795
       hours |  -.0066665   .0019986    -3.34   0.001    -.0105909   -.0027422
      tenure |   .0077155    .002955     2.61   0.009     .0019132    .0135178
     married |   .2023529   .0476962     4.24   0.000     .1086967    .2960091
        educ |   .0438651   .0073657     5.96   0.000     .0294018    .0583284
       _cons |     5.4996   .2016607    27.27   0.000      5.10362    5.895581
------------------------------------------------------------------------------

. 
. /*Functional Form */
. 
. /* F Test */
. 
. reg  lwage south brthord kww sibs feduc tenure  married black hours educ age meduc

      Source |       SS           df       MS      Number of obs   =       663
-------------+----------------------------------   F(12, 650)      =     16.63
       Model |   26.416293        12  2.20135775   Prob > F        =    0.0000
    Residual |  86.0668822       650  .132410588   R-squared       =    0.2348
-------------+----------------------------------   Adj R-squared   =    0.2207
       Total |  112.483175       662  .169914162   Root MSE        =    .36388

------------------------------------------------------------------------------
       lwage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       south |     -.0838   .0314578    -2.66   0.008    -.1455711   -.0220289
     brthord |  -.0167837   .0119862    -1.40   0.162      -.04032    .0067526
         kww |   .0067305   .0023903     2.82   0.005     .0020369    .0114241
        sibs |   .0053631   .0081421     0.66   0.510    -.0106248     .021351
       feduc |   .0079674   .0055787     1.43   0.154     -.002987    .0189218
      tenure |   .0078633    .002952     2.66   0.008     .0020668    .0136598
     married |   .1967992   .0476677     4.13   0.000     .1031979    .2904005
       black |  -.0846613   .0558859    -1.51   0.130       -.1944    .0250775
       hours |  -.0069189   .0019991    -3.46   0.001    -.0108444   -.0029934
        educ |   .0409417   .0076049     5.38   0.000     .0260086    .0558747
         age |   .0118407   .0053439     2.22   0.027     .0013473    .0223341
       meduc |   .0096308   .0063914     1.51   0.132    -.0029196    .0221812
       _cons |   5.560053   .2098306    26.50   0.000     5.148025     5.97208
------------------------------------------------------------------------------

. 
. test meduc feduc

 ( 1)  meduc = 0
 ( 2)  feduc = 0

       F(  2,   650) =    4.01
            Prob > F =    0.0187

. 
. test meduc=feduc

 ( 1)  - feduc + meduc = 0

       F(  1,   650) =    0.03
            Prob > F =    0.8711

. 
. test educ tenure hours

 ( 1)  educ = 0
 ( 2)  tenure = 0
 ( 3)  hours = 0

       F(  3,   650) =   15.51
            Prob > F =    0.0000

. 
. exit 

end of do-file


