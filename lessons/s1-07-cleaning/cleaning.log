------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/doylewr/practicum/fall_2016/central/lessons/cleaning/cleaning.log
  log type:  text
 opened on:  24 Oct 2016, 16:21:50

. 
. // NAME: Data cleaning
. // FILE: lecture9_cleaning.do
. // AUTH: Will Doyle
. // REVS: Benjamin Skinner
. // INIT: 15 October 2014
. // LAST: 24 Ocotber 2016
.      
. clear all                               // clear memory

. set more off                            // turn off annoying "__more__" feature

. 
. // load CA school data with problems
. use caschool_problem, replace

. 
. // replacing problematic variable labels 
. describe

Contains data from caschool_problem.dta
  obs:           420                          
 vars:            19                          19 Oct 2010 10:56
 size:        60,060                          
------------------------------------------------------------------------------------------
              storage   display    value
variable name   type    format     label      variable label
------------------------------------------------------------------------------------------
observation_n~r float   %9.0g                 Observation
dist_cod        float   %9.0g                 District Code
county          str18   %18s                  County
district        str53   %53s                  District
gr_span         str8    %8s                   gr
enrl_tot        float   %9.0g                 Enrollment as of census
teachers        float   %9.0g                 teachers
calw_pct        float   %9.0g                 
meal_pct        float   %9.0g                 Meals
computer        float   %9.0g                 computer
testscr         float   %9.0g                 API INDEX
comp_stu        float   %9.0g                 comp_stu
expn_stu        float   %9.0g                 Expenditures per student
str             float   %9.0g                 ratio
avginc          float   %9.0g                 avginc
el_pct          float   %9.0g                 ELL
read_scr        float   %9.0g                 
math_scr        float   %9.0g                 
foo             float   %9.0g                 
------------------------------------------------------------------------------------------
Sorted by:  

. label variable gr_span "Grade Span"

. 
. // LOOKING FOR OUTLIERS WITH VARIOUS PLOTS
. 
. // box plot str
. graph box str, name(box_str)

. graph export  box_str.eps, name(box_str) replace
(note: file box_str.eps not found)
(file box_str.eps written in EPS format)

. 
. // histogram str
. histogram str, name(hist_str)
(bin=20, start=14, width=1.6700001)

. graph export  hist_str.eps, name(hist_str) replace
(note: file hist_str.eps not found)
(file hist_str.eps written in EPS format)

. 
. // IMPOSSIBLE VALUES 
. 
. // summarize calw percent
. sum calw_pct

    Variable |       Obs        Mean    Std. Dev.       Min        Max
-------------+--------------------------------------------------------
    calw_pct |       420    13.46038    12.25822          0      102.7

. 
. // LOOKING FOR IMPLAUSIBLE VALUES WITH VARIOUS PLOTS
. 
. // twoway scatter of avginc and meal_pct
. graph twoway scatter avginc meal_pct, name(sc_inc_meal)

. graph export  sc_inc_meal.eps, name(sc_inc_meal) replace
(note: file sc_inc_meal.eps not found)
(file sc_inc_meal.eps written in EPS format)

. 
. // CHECKING CALCUATIONS
. 
. // create new student teacher ratio variable
. gen str_two = enrl_tot / teachers

. 
. // twoway scatter of both student teacher ratio variables
. graph twoway scatter str_two str, name(sc_str_str_two)

. graph export  sc_str_str_two.eps, name(sc_str_str_two) replace
(note: file sc_str_str_two.eps not found)
(file sc_str_str_two.eps written in EPS format)

. 
. // assume negative means missing and drop
. replace teachers = . if teachers == -4
(67 real changes made, 67 to missing)

. 
. // create another new student teacher ratio variable
. gen str_three = enrl_tot / teachers
(67 missing values generated)

. 
. // twoway scatter of new new and old student teacher ratio variables
. graph twoway scatter str_three str, name(sc_str_str_three)

. graph export  sc_str_str_three.eps, name(sc_str_str_three) replace
(note: file sc_str_str_three.eps not found)
(file sc_str_str_three.eps written in EPS format)

. 
. // LOOKING FOR DUPLICATES 
. 
. // check for duplicate observations
. duplicates report observation_number

Duplicates in terms of observation_number

--------------------------------------
   copies | observations       surplus
----------+---------------------------
        1 |          420             0
--------------------------------------

. 
. // check for duplicate district cod
. duplicates report dist_cod

Duplicates in terms of dist_cod

--------------------------------------
   copies | observations       surplus
----------+---------------------------
        1 |          418             0
        2 |            2             1
--------------------------------------

. 
. // CHECK FOR NEGATIVE VALUES, MISSING DATA
. 
. // inspect test scores
. inspect testscr

testscr:  API INDEX                             Number of Observations
-------------------                         ------------------------------
                                            Total   Integers   Nonintegers
|          #                 Negative           -         -          -
|          #                 Zero               -         -          -
|      #   #                 Positive         420        17        403
|      #   #   #                            -----     -----      -----
|      #   #   #             Total            420        17        403
|  #   #   #   #   .         Missing            -
+----------------------                     -----
605.55           706.75                       420
(More than 99 unique values)

. 
. // inspect reading scores
. inspect read_scr

read_scr:                                       Number of Observations
-----------                                 ------------------------------
                                            Total   Integers   Nonintegers
|                  #         Negative          77        77          -
|                  #         Zero              15        15          -
|                  #         Positive         328        33        295
|                  #                        -----     -----      -----
|                  #         Total            420       125        295
|  #   .   .   .   #         Missing            -
+----------------------                     -----
-1                  704                       420
(More than 99 unique values)

. 
. // plot reading scores for further investigation
. histogram read_scr, name(hist_read_scr)
(bin=20, start=-1, width=35.25)

. graph export hist_read_scr.eps, name(hist_read_scr) replace                             
>                  
(note: file hist_read_scr.eps not found)
(file hist_read_scr.eps written in EPS format)

. 
. // end file     
. log close
      name:  <unnamed>
       log:  /Users/doylewr/practicum/fall_2016/central/lessons/cleaning/cleaning.log
  log type:  text
 closed on:  24 Oct 2016, 16:21:58
------------------------------------------------------------------------------------------
