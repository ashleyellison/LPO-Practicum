----------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/doylewr/practicum/lpo_prac_2016-2017/central/lessons/ols_in_stata/reporting_resu
> lts.log
  log type:  text
 opened on:  24 Jan 2017, 09:25:38

. 
. /* PhD Practicum, Spring 2017 */
. /* Outputting regression results*/
. /* Will Doyle*/
. /* 1/24/17 */
. /* Saved on OAK */
. 
. clear

. 
. /*Locals*/
. 
. local tab_type rtf  /*I use tex, word=rtf */

. 
. local graph_type pdf /*Png or bmp for windows */

. 
. /* Check to see if file exists, if not then download it. */
. capture confirm file caschool.dta

. 
. if _rc==601{
. use http://fmwww.bc.edu/ec-p/data/stockwatson/caschool.dta
. save caschool, replace
. } /* End Download Section */

. 
. else use caschool

. 
. /*Transformations of key independent variabls*/
. 
. gen expn_stu_k=expn_stu/1000

. 
. gen comp_stu_h=comp_stu*100

. 
. /*Label variables*/
. 
. label variable testsc "Combined test scores"

. 
. label variable avginc "Average income"

. 
. label variable el_pct "Pct English Lang Learners"

. 
. label variable calw_pct "Pct of Families on Welfare"

. 
. label variable meal_pct "Pct Free/Reduced Lunch"

. 
. label variable str "Student/Teacher Ratio"

. 
. label variable expn_stu "Expenditures/student"

. 
. label variable expn_stu_k "Expenditures/student (1000s)"

. 
. label variable comp_stu "Computers/Student"

. 
. label variable comp_stu_h "Computers/100 Students"

. 
. 
. /*Locals*/
. 
. local y testscr

. 
. local students avginc el_pct calw_pct meal_pct

. 
. local teacher str

. 
. local finance expn_stu_k

. 
. local computers comp_stu_h

. 
. estimates clear

. 
. /* Setting up and outputting descriptive stats */
. 
. eststo descriptives: estpost tabstat `y' `students' `teacher' `finance', ///
>     statistics(mean sd) ///
>     columns(statistics) ///
>     listwise 

Summary statistics: mean sd
     for variables: testscr avginc el_pct calw_pct meal_pct str expn_stu_k

             |   e(mean)      e(sd) 
-------------+----------------------
     testscr |  654.1565   19.05335 
      avginc |  15.31659    7.22589 
      el_pct |  15.76816   18.28593 
    calw_pct |  13.24604   11.45482 
    meal_pct |  44.70524   27.12338 
         str |  19.64043   1.891812 
  expn_stu_k |  5.312408   .6339371 

.     
. esttab descriptives using esttab_means.`tab_type' , ///
>     main(mean) ///
>     aux(sd) ///
>     nostar ///
>     nonote ///
>     label ///
>     nonumber ///
>     replace 
(output written to esttab_means.rtf)

.         
. /* Conditional Means, etc. */
. 
. /* Three groups: small class size, middle, and large */
. sum str, detail 

                    Student/Teacher Ratio
-------------------------------------------------------------
      Percentiles      Smallest
 1%     15.13898             14
 5%     16.41658       14.20176
10%     17.34573       14.54214       Obs                 420
25%     18.58179       14.70588       Sum of Wgt.         420

50%     19.72321                      Mean           19.64043
                        Largest       Std. Dev.      1.891812
75%     20.87183          24.95
90%     21.87561       25.05263       Variance       3.578952
95%     22.64514       25.78512       Skewness      -.0253655
99%     24.88889           25.8       Kurtosis       3.609597

.   
. gen class_size=str<=r(p25)

. 
. replace class_size=2 if str>r(p25)&str<=r(p75)
(210 real changes made)

. 
. replace class_size=3 if str>r(p75)
(105 real changes made)

. 
. replace class_size=. if str==.
(0 real changes made)

. 
. label define sizes 1 "Small Class Size" 2 "Medium Class Size"  3 "Large Class Size"

. 
. label values class_size sizes

. 
. /*Summary table */
. 
. eststo descriptives_size: estpost tabstat `y' `students' `teacher' `finance', ///
>     by(class_size) ///
>     statistics(mean sd) ///
>     columns(statistics) ///
>     listwise 

Summary statistics: mean sd
     for variables: testscr avginc el_pct calw_pct meal_pct str expn_stu_k
  by categories of: class_size

  class_size |   e(mean)      e(sd) 
-------------+----------------------
Small Clas~e |                      
     testscr |  659.9914   21.30227 
      avginc |  17.80907   10.78676 
      el_pct |  11.23263   16.98024 
    calw_pct |  13.19018   12.09932 
    meal_pct |  40.20112   29.78182 
         str |  17.22926   1.069095 
  expn_stu_k |  5.844176   .7127741 
-------------+----------------------
Medium Cla~e |                      
     testscr |  654.1148   17.86415 
      avginc |  14.85916   5.688771 
      el_pct |  15.42214   17.61338 
    calw_pct |  13.20786   11.57226 
    meal_pct |  44.02096   25.93847 
         str |  19.68908   .6305783 
  expn_stu_k |  5.247282   .4960094 
-------------+----------------------
Large Clas~e |                      
     testscr |  648.4052   17.31211 
      avginc |  13.73897   4.445559 
      el_pct |   20.9957   19.66651 
    calw_pct |  13.37827   10.63472 
    meal_pct |  50.57791   25.85828 
         str |  21.95428   1.094183 
  expn_stu_k |  4.910889   .3997575 
-------------+----------------------
Total        |                      
     testscr |  654.1565   19.05335 
      avginc |  15.31659    7.22589 
      el_pct |  15.76816   18.28593 
    calw_pct |  13.24604   11.45482 
    meal_pct |  44.70524   27.12338 
         str |  19.64043   1.891812 
  expn_stu_k |  5.312408   .6339371 

. 
. esttab descriptives_size using esttab_means_size.`tab_type', ///
>     main(mean) ///
>     aux(sd) ///
>     nostar ///
>     nonote ///
>     label ///
>     unstack ///
>     nonumbers ///
>     nomtitles ///
>         collabels(none) ///
>     replace 
(output written to esttab_means_size.rtf)

.         
. /* Estimate Models */
.         
. quietly reg `y' `teacher'

. estimates store teach_model, title ("Model 1")                                

. 
. quietly reg `y'  `teacher' `students'

. estimates store st_tch_model, title ("Model 2")

. 
. quietly reg `y' `students' `teacher' `finance'

. estimates store st_tch_fin_model, title ("Model 3")

. 
. quietly reg `y' `students' `teacher' `finance' `computers'

. estimates store st_tch_fin_comp_model, title ("Model 4")

. 
. #delimit;
delimiter now ;
. esttab *_model using `y'_models.`tab_type',          /* estout command: * indicates all estimates 
> in memory. rtf specifies rich text, best for word */
>                label                          /*Use labels for models and variables */
>                nodepvars                      /* Use my model titles */
>                b(2)                           /* b= coefficients , this gives two sig digits */
>                se(2)                         /* I do want standard errors */
>                r2 (2)                      /* R squared */
>                ar2 (2)                     /* Adj R squared */
>                scalar(F  "df_m DF model"  "df_r DF residual" N)   /* select stats from the ereturn
>  (list) */
>                sfmt (2 0 0 0)                /* format for scalar stats*/
>                replace                   /* replace existing file */
>                ;
(output written to testscr_models.rtf)

. #delimit cr
delimiter now cr
. 
. estimates restore teach_model
(results teach_model are active now)

. 
. #delimit;
delimiter now ;
. plotbeta  avginc|el_pct|calw_pct|meal_pct|str, /*Variables in regression to report */
>           labels                              /*Use Variable Labels*/
>           xtitle (Parameters)                 /*Label of x axis*/
>           title ("Model w/ No Covariates")    /*Title */ 
>           subtitle ("From OLS regression. Dep Var= Test Scores") /*Description */
>           xline(0,lp(dash)) /* Line at 0: if95% ci crosses, not stat sig */
>           xscale(range(-1.5 4)) /* Range of X axis*/
>                   xlabel(-4(.5)4)
>                   scale(.5)
>                   ;
NOTE: Make sure there are no options in the lincom expressions
lincom avginc failed
This term will not be plotted
lincom el_pct failed
This term will not be plotted
lincom calw_pct failed
This term will not be plotted
lincom meal_pct failed
This term will not be plotted

. #delimit cr
delimiter now cr
. 
. graph save teach_model, replace
(file teach_model.gph saved)

. 
. estimates restore st_tch_model
(results st_tch_model are active now)

. 
. #delimit;
delimiter now ;
. plotbeta avginc|el_pct|calw_pct|meal_pct|str, /*Variables in regression to report */
>           labels                              /*Use Variable Labels*/
>           xtitle (Parameters)                 /*Label of x axis*/
>           title ("Model w/ Student Chars")    /*Title */ 
>           subtitle ("From OLS regression. Dep Var= Test Scores") /*Description */
>           xline(0,lp(dash)) /* Line at 0: if95% ci crosses, not stat sig */
>           xscale(range(-1.5 4)) /* Range of X axis*/
>                   xlabel(-4(.5)4)
>                   scale(.5)
>                   ;
NOTE: Make sure there are no options in the lincom expressions

. #delimit cr
delimiter now cr
. 
. graph save st_teach_model, replace
(file st_teach_model.gph saved)

. 
. estimates restore st_tch_fin_model
(results st_tch_fin_model are active now)

. 
. #delimit;
delimiter now ;
. plotbeta avginc|el_pct|calw_pct|meal_pct|expn_stu_k|str,
>           labels
>           xtitle (Parameters)
>           title ("Model w/ Spending")
>           subtitle ("From OLS regression. Dep Var= Test Scores")
>           xline(0,lp(dash))
>           xscale(range(-1.4 4))
>           xlabel(-4(.5)4)
>                   scale(.5)
>                   ;
NOTE: Make sure there are no options in the lincom expressions

. graph save st_teach_fin_model,replace;
(file st_teach_fin_model.gph saved)

. estimates restore st_tch_fin_comp_model;
(results st_tch_fin_comp_model are active now)

.  #delimit;
delimiter now ;
. plotbeta avginc|el_pct|calw_pct|meal_pct|expn_stu_k|comp_stu|str,
>           labels
>           xtitle (Parameters)
>           title ("Full Model")
>           subtitle ("From OLS regression. Dep Var= Test Scores")
>           xline(0,lp(dash))
>           xscale(range(-1.4 4))
>           xlabel(-4(.5)4)
>                   scale(.5)
>                   ;
NOTE: Make sure there are no options in the lincom expressions

. graph save st_teach_fin_comp_model,replace;
(file st_teach_fin_comp_model.gph saved)

. graph combine teach_model.gph //
>         st_teach_model.gph //
>         st_teach_fin_model.gph //
>         st_teach_fin_comp_model.gph
>         ,
>          cols(2)
>          rows(2)
>          ;

. #delimit cr
delimiter now cr
. 
. 
. graph export all_models.eps, replace 
(note: file all_models.eps not found)
(file all_models.eps written in EPS format)

. 
. exit

end of do-file


. do "/Users/doylewr/practicum/lpo_prac_2016-2017/central/lessons/ols_in_stata/ols_regression_stata.
> do"

. capture log close
